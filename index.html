<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
:root{
  --azul:#2f80ed;
  --gris:#eef1f4;
  --card:#ffffff;
  --texto:#333;
  --borde:#d0d4d9;
  --ok:#27ae60;
  --rojo:#c0392b;
}

body{
  margin:0;
  font-family: system-ui, Arial, sans-serif;
  background:var(--gris);
  color:var(--texto);
}

.header{
  padding:20px;
  background:#f7f9fb;
  text-align:center;
}

.pattern-area{ padding:20px; }

.card{
  max-width:420px;
  margin:0 auto 16px;
  background:var(--card);
  padding:22px;
  border-radius:18px;
  box-shadow:0 14px 32px rgba(0,0,0,.15);
}

.hidden{ display:none; }

button{
  width:100%;
  height:52px;
  border-radius:14px;
  border:none;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  margin-top:14px;
  background:var(--azul);
  color:white;
}

.secondary{ background:#6c757d; }
.ok{ background:var(--ok); }
.danger{ background:var(--rojo); }

.row{ margin-top:14px; }
.label{ font-size:14px; font-weight:600; margin-bottom:6px; }

input{
  width:100%;
  height:52px;
  padding:14px;
  border-radius:14px;
  border:1px solid var(--borde);
  box-sizing:border-box;
}

.list-item{
  border:1px solid var(--borde);
  border-radius:14px;
  padding:14px;
  margin-top:12px;
}

.badge{
  display:inline-block;
  background:#eef3ff;
  color:#2f80ed;
  padding:6px 10px;
  border-radius:10px;
  font-size:13px;
  margin:6px 6px 0 0;
}
</style>
</head>

<body>

<div class="header">
  <h1>üíä Recordatorio de Medicamentos</h1>
</div>

<div class="pattern-area">

  <!-- HOME -->
  <div class="card" id="home">
    <h2>Men√∫ principal</h2>
    <button onclick="mostrarSeccion('perfil')">üë§ Datos personales</button>
    <button onclick="mostrarSeccion('medicamentos')">üíä Medicamentos</button>
    <button onclick="mostrarSeccion('seguimiento')">üìä Seguimiento</button>
  </div>

  <!-- PERFIL -->
  <div class="card hidden" id="perfil">
    <h3>Datos personales</h3>
    <div id="perfilResumen"></div>
    <button class="secondary" onclick="volverHome()">‚¨Ö Volver</button>
  </div>

  <!-- MEDICAMENTOS -->
  <div class="card hidden" id="medicamentos">
    <h3>Medicamentos</h3>
    <div id="lista"></div>
    <button onclick="mostrarForm()">Agregar medicamento</button>
    <button class="secondary" onclick="volverHome()">‚¨Ö Volver</button>
  </div>

  <!-- FORMULARIO MED -->
  <div class="card hidden" id="formMed">
    <h3>Nuevo medicamento</h3>

    <div class="row"><div class="label">Nombre</div><input id="medNombre"></div>
    <div class="row"><div class="label">Dosis</div><input id="medDosis"></div>
    <div class="row"><div class="label">Lugar</div><input id="medLugar"></div>

    <div class="row"><div class="label">Horario</div>
      <input type="time" id="horaInput">
      <button class="secondary" onclick="agregarHora()">Agregar horario</button>
      <div id="horas"></div>
    </div>

    <button class="ok" onclick="guardarMed()">Guardar</button>
    <button class="secondary" onclick="cerrarForm()">Cancelar</button>
  </div>

  <!-- SEGUIMIENTO -->
  <div class="card hidden" id="seguimiento">
    <h3>Seguimiento</h3>
    <div id="listaSeguimiento"></div>
    <button class="secondary" onclick="volverHome()">‚¨Ö Volver</button>
  </div>

</div>

<script>
// ===== NAVEGACI√ìN =====
function mostrarSeccion(id){
  ["home","perfil","medicamentos","seguimiento","formMed"].forEach(s=>{
    const el = document.getElementById(s);
    if(el) el.classList.add("hidden");
  });
  document.getElementById(id).classList.remove("hidden");
  if(id==="seguimiento") renderSeguimiento();
}
function volverHome(){ mostrarSeccion("home"); }

// ===== PERFIL =====
const usuario = JSON.parse(localStorage.getItem("usuario")) || {
  nombre:"Usuario",
  cuidadorNombre:"Cuidador",
  cuidadorTelefono:""
};
perfilResumen.innerHTML = `
<strong>${usuario.nombre}</strong><br>
Cuidador: ${usuario.cuidadorNombre}<br>
Tel: ${usuario.cuidadorTelefono}
`;

// ===== MEDICAMENTOS =====
let tratamientos = JSON.parse(localStorage.getItem("tratamientos")) || [];
let historialTomas = JSON.parse(localStorage.getItem("historialTomas")) || [];
let horasTemp=[];

function renderLista(){
  lista.innerHTML="";
  tratamientos.forEach((t,i)=>{
    lista.innerHTML+=`
      <div class="list-item">
        <strong>${t.nombre}</strong><br>
        Dosis: ${t.dosis}<br>
        üìç ${t.lugar}<br>
        Horarios: ${t.horarios.join(", ")}
        <button class="secondary" onclick="eliminar(${i})">Eliminar</button>
      </div>`;
  });
}

function mostrarForm(){ mostrarSeccion("formMed"); }
function cerrarForm(){ mostrarSeccion("medicamentos"); }

function agregarHora(){
  if(!horaInput.value) return;
  horasTemp.push(horaInput.value);
  horas.innerHTML = horasTemp.map(h=>`<span class="badge">${h}</span>`).join("");
  horaInput.value="";
}

function guardarMed(){
  tratamientos.push({
    nombre: medNombre.value,
    dosis: medDosis.value,
    lugar: medLugar.value,
    horarios: horasTemp,
    activo:true
  });
  localStorage.setItem("tratamientos",JSON.stringify(tratamientos));
  horasTemp=[]; horas.innerHTML="";
  cerrarForm(); renderLista();
}

function eliminar(i){
  tratamientos.splice(i,1);
  localStorage.setItem("tratamientos",JSON.stringify(tratamientos));
  renderLista();
}

// ===== SEGUIMIENTO =====
function renderSeguimiento(){
  listaSeguimiento.innerHTML="";
  historialTomas.slice().reverse().forEach(h=>{
    listaSeguimiento.innerHTML+=`
      <div class="list-item">
        <strong>${h.medicamento}</strong><br>
        Fecha: ${h.fecha} ‚Äì ${h.hora}<br>
        Estado: ${h.estado}
      </div>`;
  });
}

renderLista();
mostrarSeccion("home");
</script>

</body>
</html>
