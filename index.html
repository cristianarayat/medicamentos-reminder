<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
/* =========================
   ESTILOS GENERALES
   ========================= */
body{
  margin:0;
  font-family: system-ui, Arial, sans-serif;
  background:#eef1f4;
  color:#333;
}

header{
  text-align:center;
  padding:16px;
  background:#f7f9fb;
}

header img{
  width:90%;
  max-width:420px;
  margin-top:10px;
}

.container{
  max-width:480px;
  margin:auto;
  padding:16px;
}

.card{
  background:#fff;
  border-radius:18px;
  padding:20px;
  margin-bottom:16px;
  box-shadow:0 12px 28px rgba(0,0,0,.12);
}

.hidden{ display:none; }

h2,h3{
  margin-top:0;
}

/* =========================
   BOTONES
   ========================= */
button{
  width:100%;
  height:52px;
  border:none;
  border-radius:14px;
  background:#2f80ed;
  color:white;
  font-size:16px;
  font-weight:700;
  margin-top:12px;
  cursor:pointer;
}

button.secondary{ background:#6c757d; }
button.danger{ background:#c0392b; }

/* =========================
   INPUTS
   ========================= */
.field{
  margin-top:14px;
}

.field label{
  font-size:14px;
  font-weight:600;
  display:block;
  margin-bottom:6px;
}

input:not([type=checkbox]):not([type=time]):not([type=file]){
  width:100%;
  height:52px;
  border-radius:12px;
  border:1px solid #ccc;
  padding:12px;
  box-sizing:border-box;
  font-size:15px;
}

input[type=time],
input[type=file]{
  width:100%;
  height:42px;
}

/* =========================
   SWITCHES
   ========================= */
.switch{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-top:14px;
}

.switch-left{
  display:flex;
  align-items:center;
  gap:8px;
}

.switch img{
  width:24px;
  height:24px;
}

.switch input{
  width:44px;
  height:24px;
}

/* =========================
   MEDICAMENTOS LISTA
   ========================= */
.med-item{
  border:1px solid #ddd;
  border-radius:14px;
  padding:14px;
  margin-top:12px;
}

.med-item img{
  width:100%;
  max-height:160px;
  object-fit:contain;
  margin-top:8px;
}
</style>
</head>

<body>

<header>
  <h1>üíä Recordatorio de Medicamentos</h1>
  <img src="personas-inclusivas.png" alt="Personas">
</header>

<div class="container">

<!-- =========================
     MEN√ö PRINCIPAL
     ========================= -->
<div class="card" id="menu">
  <div id="bienvenida"></div>

  <button onclick="mostrar('perfil')">Datos personales</button>
  <button onclick="mostrar('medicamentos')">Medicamentos</button>
  <button onclick="mostrar('seguimiento')">Seguimiento</button>
</div>

<!-- =========================
     DATOS PERSONALES
     ========================= -->
<div class="card hidden" id="perfil">
  <h3>Datos personales</h3>

  <div class="field">
    <label>Nombre</label>
    <input id="nombre">
  </div>

  <div class="field">
    <label>Fecha de nacimiento</label>
    <input type="date" id="fechaNacimiento">
  </div>

  <div class="field">
    <label>Nombre del cuidador</label>
    <input id="cuidadorNombre">
  </div>

  <div class="field">
    <label>Tel√©fono del cuidador</label>
    <input id="cuidadorTelefono">
  </div>

  <div class="switch">
    <div class="switch-left">
      <img src="https://img.icons8.com/ios-filled/50/vibration.png">
      <span>Vibraci√≥n</span>
    </div>
    <input type="checkbox" id="vibracion">
  </div>

  <div class="switch">
    <div class="switch-left">
      <img src="https://img.icons8.com/ios-filled/50/voice.png">
      <span>Mensaje por voz</span>
    </div>
    <input type="checkbox" id="voz">
  </div>

  <button onclick="guardarPerfil()">Guardar</button>
  <div id="msgPerfil"></div>
  <button class="secondary" onclick="mostrar('menu')">Volver</button>
</div>

<!-- =========================
     MEDICAMENTOS
     ========================= -->
<div class="card hidden" id="medicamentos">
  <h3>Medicamentos</h3>

  <div class="field">
    <label>Nombre del medicamento</label>
    <input id="medNombre">
  </div>

  <div class="field">
    <label>Dosis por d√≠a</label>
    <input type="number" id="medDosis" min="1" value="1">
  </div>

  <div class="field">
    <label>Horario</label>
    <input type="time" id="medHorario">
  </div>

  <div class="switch">
    <span>Permanente</span>
    <input type="checkbox" id="medPermanente">
  </div>

  <div class="field">
    <label>Cantidad de d√≠as</label>
    <input type="number" id="medDias">
  </div>

  <div class="field">
    <label>Lugar donde se guarda</label>
    <input id="medLugar">
  </div>

  <div class="field">
    <label>Foto (opcional)</label>
    <input type="file" id="medFoto" accept="image/*">
  </div>

  <button onclick="guardarMedicamento()">Guardar medicamento</button>

  <div id="listaMedicamentos"></div>

  <button class="secondary" onclick="mostrar('menu')">Volver</button>
</div>

<!-- =========================
     SEGUIMIENTO
     ========================= -->
<div class="card hidden" id="seguimiento">
  <h3>Seguimiento</h3>
  <p>Pr√≥xima fase.</p>
  <button class="secondary" onclick="mostrar('menu')">Volver</button>
</div>

</div>

<script>
function mostrar(id){
  ["menu","perfil","medicamentos","seguimiento"].forEach(v=>{
    document.getElementById(v).classList.add("hidden");
  });
  document.getElementById(id).classList.remove("hidden");
}

/* ===== EDAD ===== */
function calcularEdad(fecha){
  if(!fecha) return "";
  const hoy = new Date();
  const nac = new Date(fecha);
  let a√±os = hoy.getFullYear() - nac.getFullYear();
  let meses = hoy.getMonth() - nac.getMonth();
  if(hoy.getDate() < nac.getDate()) meses--;
  if(meses < 0){ a√±os--; meses+=12; }
  return `${a√±os} a√±os y ${meses} meses`;
}

/* ===== PERFIL ===== */
let usuario = JSON.parse(localStorage.getItem("usuario")) || {};

function guardarPerfil(){
  if(cuidadorTelefono.value.trim().length < 8){
    msgPerfil.innerHTML = "Tel√©fono inv√°lido";
    return;
  }

  usuario = {
    nombre:nombre.value,
    fechaNacimiento:fechaNacimiento.value,
    cuidadorNombre:cuidadorNombre.value,
    cuidadorTelefono:cuidadorTelefono.value,
    vibracion:vibracion.checked,
    voz:voz.checked
  };

  localStorage.setItem("usuario", JSON.stringify(usuario));
  msgPerfil.innerHTML = "Datos guardados correctamente";

  bienvenida.innerHTML = `
    <strong>Bienvenido ${usuario.nombre}</strong><br>
    <small>${calcularEdad(usuario.fechaNacimiento)}</small>
  `;
}

/* ===== MEDICAMENTOS ===== */
let meds = JSON.parse(localStorage.getItem("meds")) || [];

function guardarMedicamento(){
  if(!medNombre.value) return;

  const reader = new FileReader();
  const file = medFoto.files[0];

  reader.onload = () => {
    meds.push({
      nombre:medNombre.value,
      dosis:medDosis.value,
      horario:medHorario.value,
      permanente:medPermanente.checked,
      dias:medDias.value,
      lugar:medLugar.value,
      foto:reader.result || null
    });
    localStorage.setItem("meds", JSON.stringify(meds));
    renderMeds();
  };

  if(file) reader.readAsDataURL(file);
  else reader.onload();
}

function eliminarMed(i){
  meds.splice(i,1);
  localStorage.setItem("meds", JSON.stringify(meds));
  renderMeds();
}

function renderMeds(){
  listaMedicamentos.innerHTML="";
  meds.forEach((m,i)=>{
    listaMedicamentos.innerHTML += `
      <div class="med-item">
        <strong>${m.nombre}</strong><br>
        Dosis: ${m.dosis}<br>
        Horario: ${m.horario}<br>
        Lugar: ${m.lugar}<br>
        ${m.foto ? `<img src="${m.foto}">` : ""}
        <button class="danger" onclick="eliminarMed(${i})">Eliminar</button>
      </div>
    `;
  });
}
renderMeds();

/* INIT */
if(usuario.nombre){
  bienvenida.innerHTML = `
    <strong>Bienvenido ${usuario.nombre}</strong><br>
    <small>${calcularEdad(usuario.fechaNacimiento)}</small>
  `;
}
</script>

</body>
</html>
