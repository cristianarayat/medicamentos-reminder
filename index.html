<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#eef1f4;
}
.card{
  max-width:480px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:16px;
}
.hidden{display:none;}
button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border:none;
  border-radius:12px;
  font-size:16px;
  background:#2f80ed;
  color:#fff;
}
.secondary{background:#6c757d;}
input{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:10px;
  border:1px solid #ccc;
}
label{font-weight:bold; margin-top:10px; display:block;}
.toggle{margin-top:10px;}
</style>
</head>

<body>

<!-- HOME -->
<div class="card" id="home">
  <h2 id="bienvenida"></h2>
  <button onclick="mostrar('perfil')">üë§ Datos personales</button>
  <button onclick="mostrar('medicamentos')">üíä Medicamentos</button>
</div>

<!-- PERFIL -->
<div class="card hidden" id="perfil">
  <h3>Datos personales</h3>
  <div id="perfilResumen"></div>
  <button onclick="mostrar('perfilForm')">Modificar</button>
  <button class="secondary" onclick="mostrar('home')">Volver</button>
</div>

<!-- PERFIL FORM -->
<div class="card hidden" id="perfilForm">
  <label>Nombre</label>
  <input id="nombre">

  <label>Fecha de nacimiento</label>
  <input type="date" id="fechaNacimiento">

  <label>Nombre del cuidador</label>
  <input id="cuidadorNombre">

  <label>Tel√©fono del cuidador</label>
  <input id="cuidadorTelefono">

  <div class="toggle">
    <label><input type="checkbox" id="voz"> Activar voz</label>
  </div>

  <div class="toggle">
    <label><input type="checkbox" id="vibracion"> Activar vibraci√≥n</label>
  </div>

  <button onclick="guardarPerfil()">Guardar</button>
  <button class="secondary" onclick="mostrar('perfil')">Cancelar</button>
</div>

<!-- MEDICAMENTOS -->
<div class="card hidden" id="medicamentos">
  <h3>Medicamentos</h3>
  <div id="listaMedicamentos"></div>
  <button onclick="mostrar('medForm')">Agregar medicamento</button>
  <button class="secondary" onclick="mostrar('home')">Volver</button>
</div>

<!-- MED FORM -->
<div class="card hidden" id="medForm">
  <label>Nombre del medicamento</label>
  <input id="medNombre">

  <label>Dosis</label>
  <input id="medDosis">

  <label>Lugar donde se guarda</label>
  <input id="medLugar">

  <label>Horario (HH:MM)</label>
  <input type="time" id="medHora">

  <label>
    <input type="checkbox" id="medPermanente"> Medicamento permanente
  </label>

  <button onclick="guardarMedicamento()">Guardar</button>
  <button class="secondary" onclick="mostrar('medicamentos')">Cancelar</button>
</div>

<script>
function mostrar(id){
  document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

// PERFIL
let usuario = JSON.parse(localStorage.getItem('usuario')) || {
  nombre:'', fechaNacimiento:'', cuidadorNombre:'', cuidadorTelefono:'',
  voz:false, vibracion:false
};

function edadTexto(){
  if(!usuario.fechaNacimiento) return '';
  const n=new Date(usuario.fechaNacimiento), h=new Date();
  let a=h.getFullYear()-n.getFullYear();
  let m=h.getMonth()-n.getMonth();
  if(m<0){a--;m+=12;}
  return `${a} a√±os y ${m} meses`;
}

function renderPerfil(){
  bienvenida.innerText = `Bienvenido ${usuario.nombre || ''} ${edadTexto()}`;
  perfilResumen.innerHTML = `
    <b>Nombre:</b> ${usuario.nombre}<br>
    <b>Edad:</b> ${edadTexto()}<br>
    <b>Cuidador:</b> ${usuario.cuidadorNombre}<br>
    <b>Tel√©fono:</b> ${usuario.cuidadorTelefono}<br>
    <b>Voz:</b> ${usuario.voz?'S√≠':'No'}<br>
    <b>Vibraci√≥n:</b> ${usuario.vibracion?'S√≠':'No'}
  `;
}

function guardarPerfil(){
  usuario.nombre=nombre.value;
  usuario.fechaNacimiento=fechaNacimiento.value;
  usuario.cuidadorNombre=cuidadorNombre.value;
  usuario.cuidadorTelefono=cuidadorTelefono.value;
  usuario.voz=voz.checked;
  usuario.vibracion=vibracion.checked;
  localStorage.setItem('usuario',JSON.stringify(usuario));
  renderPerfil();
  mostrar('perfil');
}

// MEDICAMENTOS
let meds = JSON.parse(localStorage.getItem('meds')) || [];

function renderMeds(){
  listaMedicamentos.innerHTML='';
  meds.forEach(m=>{
    listaMedicamentos.innerHTML+=`
      <div>
        <b>${m.nombre}</b> - ${m.dosis}<br>
        üìç ${m.lugar}<br>
        ‚è∞ ${m.hora}<br>
        ${m.permanente?'‚ôæ Permanente':''}
        <hr>
      </div>
    `;
  });
}

function guardarMedicamento(){
  meds.push({
    nombre:medNombre.value,
    dosis:medDosis.value,
    lugar:medLugar.value,
    hora:medHora.value,
    permanente:medPermanente.checked
  });
  localStorage.setItem('meds',JSON.stringify(meds));
  renderMeds();
  mostrar('medicamentos');
}

// INIT
renderPerfil();
renderMeds();
mostrar('home');
</script>

</body>
</html>
