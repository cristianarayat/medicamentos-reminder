<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
:root{
  --azul:#2f80ed;
  --fondo:#f2f4f7;
  --blanco:#ffffff;
  --texto:#333;
}

*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}

body{
  margin:0;
  background:var(--fondo);
  color:var(--texto);
}

header{
  padding:20px;
  text-align:center;
  background:#fff;
}

header h1{
  margin:0;
  font-size:28px;
}

.container{
  max-width:420px;
  margin:20px auto;
  padding:20px;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

.menu-btn{
  width:100%;
  padding:16px;
  border:none;
  border-radius:14px;
  background:var(--azul);
  color:#fff;
  font-size:16px;
  margin-bottom:12px;
  cursor:pointer;
}

.menu-btn.gray{
  background:#6c757d;
}

img.main-img{
  width:100%;
  border-radius:14px;
  margin-top:20px;
}

/* SWITCH */
.switch{
  position:relative;
  display:inline-block;
  width:46px;
  height:26px;
}
.switch input{display:none}
.slider{
  position:absolute;
  cursor:pointer;
  inset:0;
  background:#ccc;
  border-radius:26px;
  transition:.3s;
}
.slider:before{
  content:"";
  position:absolute;
  height:20px;width:20px;
  left:3px;top:3px;
  background:#fff;
  border-radius:50%;
  transition:.3s;
}
input:checked + .slider{
  background:var(--azul);
}
input:checked + .slider:before{
  transform:translateX(20px);
}

/* FORM */
input,select{
  width:100%;
  padding:12px;
  margin-top:6px;
  margin-bottom:16px;
  border-radius:10px;
  border:1px solid #ccc;
}

.days{
  display:flex;
  justify-content:space-between;
  margin:12px 0;
}
.days label{
  font-size:12px;
}

.hidden{display:none}

.med-item{
  border-top:1px solid #ddd;
  padding-top:12px;
  margin-top:12px;
}

footer{
  text-align:center;
  font-size:13px;
  padding:20px;
  color:#777;
}
</style>
</head>

<body>

<header>
  <h1>üíä Recordatorio de Medicamentos</h1>
</header>

<div class="container">

<!-- HOME -->
<div id="home" class="card">
  <h3 id="bienvenida"></h3>

  <button class="menu-btn" onclick="mostrar('datos')">üë§ Datos personales</button>
  <button class="menu-btn" onclick="mostrar('medicamentos')">üíä Medicamentos</button>
  <button class="menu-btn">üìä Seguimiento</button>

  <img src="personas-inclusivas.png" class="main-img">
</div>

<!-- DATOS PERSONALES -->
<div id="datos" class="card hidden">
  <h3>Datos personales</h3>

  <label>Nombre</label>
  <input id="nombre">

  <label>Fecha nacimiento</label>
  <input type="date" id="fecha">

  <label>Nombre cuidador</label>
  <input id="cuidador">

  <label>Tel√©fono cuidador</label>
  <input id="telefono">

  <div style="display:flex;justify-content:space-between;align-items:center">
    üì≥ Vibraci√≥n
    <label class="switch">
      <input type="checkbox" id="vibracion">
      <span class="slider"></span>
    </label>
  </div>

  <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
    üîä Voz
    <label class="switch">
      <input type="checkbox" id="voz">
      <span class="slider"></span>
    </label>
  </div>

  <button class="menu-btn" onclick="guardarDatos()">Guardar</button>
  <button class="menu-btn gray" onclick="mostrar('home')">‚Üê Volver</button>
</div>

<!-- MEDICAMENTOS -->
<div id="medicamentos" class="card hidden">
  <h3>Medicamentos</h3>

  <label>Nombre</label>
  <input id="medNombre">

  <label>Dosis</label>
  <input type="number" id="medDosis" min="1" value="1" onchange="crearHorarios()">

  <div id="horarios"></div>

  <div class="days">
    <label><input type="checkbox" value="L">L</label>
    <label><input type="checkbox" value="M">M</label>
    <label><input type="checkbox" value="X">X</label>
    <label><input type="checkbox" value="J">J</label>
    <label><input type="checkbox" value="V">V</label>
    <label><input type="checkbox" value="S">S</label>
    <label><input type="checkbox" value="D">D</label>
  </div>

  <label>
    Permanente
    <label class="switch">
      <input type="checkbox" id="permanente" onchange="toggleDias()">
      <span class="slider"></span>
    </label>
  </label>

  <label>Cantidad de d√≠as</label>
  <input type="number" id="dias">

  <label>Lugar donde se guarda</label>
  <input id="lugar">

  <label>Foto (opcional)</label>
  <input type="file" id="foto">

  <button class="menu-btn" onclick="guardarMedicamento()">Guardar</button>

  <div id="listaMedicamentos"></div>

  <button class="menu-btn gray" onclick="mostrar('home')">‚Üê Volver</button>
</div>

</div>

<footer>Desarrollado por CA Tecnolog√≠a</footer>

<script>
let usuario=JSON.parse(localStorage.getItem("usuario"))||{}
let meds=JSON.parse(localStorage.getItem("meds"))||[]

function mostrar(id){
  document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'))
  document.getElementById(id).classList.remove('hidden')
}

function guardarDatos(){
  const tel=document.getElementById("telefono").value
  if(tel.length<8){alert("Tel√©fono inv√°lido");return}
  usuario={
    nombre:nombre.value,
    fecha:fecha.value,
    cuidador:cuidador.value,
    telefono:telefono.value,
    vibracion:vibracion.checked,
    voz:voz.checked
  }
  localStorage.setItem("usuario",JSON.stringify(usuario))
  alert("Datos guardados correctamente")
  actualizarBienvenida()
}

function actualizarBienvenida(){
  if(!usuario.fecha)return
  const fn=new Date(usuario.fecha)
  const hoy=new Date()
  let a√±os=hoy.getFullYear()-fn.getFullYear()
  let meses=hoy.getMonth()-fn.getMonth()
  if(meses<0){a√±os--;meses+=12}
  bienvenida.innerText=`Bienvenido ${usuario.nombre} ‚Äî ${a√±os} a√±os y ${meses} meses`
}

function crearHorarios(){
  horarios.innerHTML=""
  for(let i=0;i<medDosis.value;i++){
    horarios.innerHTML+=`<input type="time">`
  }
}

function toggleDias(){
  dias.disabled=permanente.checked
}

function guardarMedicamento(){
  const hs=[...horarios.querySelectorAll("input")].map(h=>h.value)
  const d=[...document.querySelectorAll(".days input:checked")].map(d=>d.value)
  const reader=new FileReader()
  reader.onload=()=>{
    meds.push({
      nombre:medNombre.value,
      dosis:medDosis.value,
      horarios:hs,
      dias:d,
      permanente:permanente.checked,
      lugar:lugar.value,
      foto:reader.result
    })
    localStorage.setItem("meds",JSON.stringify(meds))
    mostrarLista()
  }
  if(foto.files[0])reader.readAsDataURL(foto.files[0])
  else reader.onload()
}

function mostrarLista(){
  listaMedicamentos.innerHTML=""
  meds.forEach((m,i)=>{
    listaMedicamentos.innerHTML+=`
    <div class="med-item">
      ${m.foto?`<img src="${m.foto}" width="100%">`:""}
      <strong>${m.nombre}</strong><br>
      Dosis: ${m.dosis}<br>
      Horarios: ${m.horarios.join(", ")}<br>
      D√≠as: ${m.dias.join(" ")}<br>
      Lugar: ${m.lugar}<br>
      <button onclick="eliminar(${i})">Eliminar</button>
    </div>`
  })
}

function eliminar(i){
  meds.splice(i,1)
  localStorage.setItem("meds",JSON.stringify(meds))
  mostrarLista()
}

actualizarBienvenida()
crearHorarios()
mostrarLista()
</script>

</body>
</html>
