<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
:root{
  --azul:#2f80ed;
  --fondo:#f2f4f7;
  --blanco:#ffffff;
  --texto:#333;
  --gris:#888;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:var(--fondo);
  color:var(--texto);
}

header{
  padding:20px;
  background:linear-gradient(135deg,#fff,#f5f7fa);
  display:flex;
  align-items:center;
  gap:12px;
}

header img{
  width:40px;
}

h1{
  font-size:22px;
  margin:0;
}

main{
  padding:20px;
}

.card{
  background:var(--blanco);
  border-radius:20px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}

.btn{
  width:100%;
  border:none;
  padding:16px;
  border-radius:14px;
  background:var(--azul);
  color:white;
  font-size:16px;
  margin:10px 0;
  cursor:pointer;
}

.btn-sec{
  background:#6c757d;
}

input, select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-top:6px;
}

label{
  font-weight:bold;
  margin-top:14px;
  display:block;
}

.switch{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-top:14px;
}

.switch input{
  width:50px;
  height:26px;
}

.hidden{display:none}

.img-main{
  width:100%;
  border-radius:20px;
  margin-top:10px;
}

.toast{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#333;
  color:white;
  padding:12px 20px;
  border-radius:20px;
  display:none;
}
</style>
</head>

<body>

<header>
  <img src="https://cdn-icons-png.flaticon.com/512/2966/2966484.png">
  <h1>Recordatorio de Medicamentos</h1>
</header>

<main>

<!-- HOME -->
<section id="home" class="card">
  <h2 id="bienvenida"></h2>

  <button class="btn" onclick="mostrar('perfil')">üë§ Datos personales</button>
  <button class="btn" onclick="mostrarMedicamentos()">üíä Medicamentos</button>
  <button class="btn" onclick="mostrar('seguimiento')">üìä Seguimiento</button>

  <img src="personas-inclusivas.png" class="img-main">
</section>

<!-- PERFIL -->
<section id="perfil" class="card hidden">
  <h2>Datos personales</h2>

  <label>Nombre</label>
  <input id="nombre">

  <label>Fecha de nacimiento</label>
  <input type="date" id="fechaNacimiento">

  <label>Nombre del cuidador</label>
  <input id="cuidadorNombre">

  <label>Tel√©fono del cuidador</label>
  <input id="cuidadorTelefono">

  <div class="switch">
    <span>Vibraci√≥n</span>
    <input type="checkbox" id="vibracion">
  </div>

  <div class="switch">
    <span>Aviso por voz</span>
    <input type="checkbox" id="voz">
  </div>

  <button class="btn" onclick="guardarPerfil()">Guardar</button>
  <button class="btn btn-sec" onclick="mostrar('home')">‚Üê Volver</button>
</section>

<!-- MEDICAMENTOS -->
<section id="medicamentos" class="card hidden">
  <h2>Medicamentos</h2>

  <form id="formMedicamentos" onsubmit="event.preventDefault();agregarMedicamento()">
    <label>Nombre</label>
    <input id="medNombre">

    <label>Dosis</label>
    <input id="medDosis">

    <label>Horario</label>
    <input type="time" id="medHorario">

    <div class="switch">
      <span>Permanente</span>
      <input type="checkbox" id="medPermanente">
    </div>

    <button class="btn">Guardar medicamento</button>
  </form>

  <div id="listaMedicamentos"></div>

  <button class="btn btn-sec" onclick="mostrar('home')">‚Üê Volver</button>
</section>

<!-- SEGUIMIENTO -->
<section id="seguimiento" class="card hidden">
  <h2>Seguimiento</h2>
  <p>Pr√≥ximamente</p>
  <button class="btn btn-sec" onclick="mostrar('home')">‚Üê Volver</button>
</section>

</main>

<div id="toast" class="toast"></div>

<script>
let usuario = JSON.parse(localStorage.getItem("usuario")) || {};
let medicamentos = JSON.parse(localStorage.getItem("medicamentos")) || [];

function mostrar(id){
  document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function calcularEdad(fecha){
  if(!fecha) return "";
  const f = new Date(fecha);
  const hoy = new Date();
  let a√±os = hoy.getFullYear() - f.getFullYear();
  let meses = hoy.getMonth() - f.getMonth();
  if(meses<0){a√±os--;meses+=12}
  return `${a√±os} a√±os y ${meses} meses`;
}

function actualizarHome(){
  document.getElementById("bienvenida").innerText =
    usuario.nombre ? `Bienvenido ${usuario.nombre} ‚Äì ${calcularEdad(usuario.fechaNacimiento)}` : "Bienvenido";
}

function guardarPerfil(){
  usuario={
    nombre:nombre.value,
    fechaNacimiento:fechaNacimiento.value,
    cuidadorNombre:cuidadorNombre.value,
    cuidadorTelefono:cuidadorTelefono.value,
    vibracion:vibracion.checked,
    voz:voz.checked
  };
  localStorage.setItem("usuario",JSON.stringify(usuario));
  toast("Datos guardados correctamente");
  actualizarHome();
}

function toast(msg){
  const t=document.getElementById("toast");
  t.innerText=msg;
  t.style.display="block";
  setTimeout(()=>t.style.display="none",2500);
}

/* MEDICAMENTOS */
function mostrarMedicamentos(){
  mostrar("medicamentos");
  const lista=document.getElementById("listaMedicamentos");
  lista.innerHTML="";
  if(medicamentos.length===0){
    lista.innerHTML="<p>No hay medicamentos registrados.</p>";
    return;
  }
  medicamentos.forEach(m=>{
    lista.innerHTML+=`
      <div class="card">
        <strong>${m.nombre}</strong><br>
        Dosis: ${m.dosis}<br>
        Hora: ${m.horario}<br>
        ${m.permanente?"Permanente":"Temporal"}
      </div>`;
  });
}

function agregarMedicamento(){
  const m={
    nombre:medNombre.value,
    dosis:medDosis.value,
    horario:medHorario.value,
    permanente:medPermanente.checked
  };
  if(!m.nombre||!m.dosis||!m.horario){
    toast("Completa todos los campos");
    return;
  }
  medicamentos.push(m);
  localStorage.setItem("medicamentos",JSON.stringify(medicamentos));
  formMedicamentos.reset();
  toast("Medicamento guardado");
  mostrarMedicamentos();
}

/* INICIO */
if(usuario.nombre){
  nombre.value=usuario.nombre;
  fechaNacimiento.value=usuario.fechaNacimiento||"";
  cuidadorNombre.value=usuario.cuidadorNombre||"";
  cuidadorTelefono.value=usuario.cuidadorTelefono||"";
  vibracion.checked=usuario.vibracion||false;
  voz.checked=usuario.voz||false;
}
actualizarHome();
mostrar("home");
</script>

</body>
</html>
