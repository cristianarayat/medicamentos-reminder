<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
/* =========================
   ESTILOS GENERALES
========================= */
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f2f4f7;
  color:#333;
}
h1,h2,h3{margin:0 0 10px}
.hidden{display:none}
.container{
  max-width:420px;
  margin:auto;
  padding:15px;
}
.card{
  background:#fff;
  border-radius:14px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 8px 20px rgba(0,0,0,.1);
}
button{
  width:100%;
  padding:14px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  font-size:16px;
  background:#2f80ed;
  color:#fff;
}
button.sec{background:#6c757d}
label{font-size:14px;font-weight:bold}
input,select{
  width:100%;
  padding:12px;
  margin-top:5px;
  border-radius:8px;
  border:1px solid #ccc;
}
.footer{
  text-align:center;
  font-size:13px;
  opacity:.7;
  margin-top:20px;
}

/* =========================
   SWITCH
========================= */
.switch{
  display:flex;
  align-items:center;
  gap:10px;
  margin-top:10px;
}
.switch input{display:none}
.slider{
  width:46px;height:24px;
  background:#ccc;
  border-radius:24px;
  position:relative;
}
.slider:before{
  content:"";
  position:absolute;
  width:20px;height:20px;
  left:2px;top:2px;
  background:#fff;
  border-radius:50%;
  transition:.3s;
}
input:checked + .slider{
  background:#2f80ed;
}
input:checked + .slider:before{
  transform:translateX(22px);
}

/* =========================
   MEDICAMENTOS
========================= */
.med-item{
  border-top:1px solid #eee;
  padding-top:10px;
  margin-top:10px;
}
.med-item img{
  width:100%;
  border-radius:10px;
  margin-top:5px;
}
</style>
</head>

<body>

<div class="container">

<!-- =========================
     HOME
========================= -->
<div id="home" class="card">
  <h1>ðŸ’Š Recordatorio de Medicamentos</h1>
  <div id="bienvenida"></div>

  <button onclick="mostrar('perfil')">ðŸ‘¤ Datos personales</button>
  <button onclick="mostrar('medicamentos')">ðŸ’Š Medicamentos</button>
  <button onclick="mostrar('seguimiento')">ðŸ“Š Seguimiento</button>

  <img src="activos/personas-inclusivas.png" style="width:100%;margin-top:15px">

  <div class="footer">Desarrollado por CA TecnologÃ­a</div>
</div>

<!-- =========================
     PERFIL
========================= -->
<div id="perfil" class="card hidden">
  <h2>Datos personales</h2>

  <label>Nombre</label>
  <input id="nombre">

  <label>Fecha de nacimiento</label>
  <input type="date" id="fechaNacimiento">

  <label>Nombre cuidador</label>
  <input id="cuidadorNombre">

  <label>TelÃ©fono cuidador</label>
  <input id="cuidadorTelefono">

  <div class="switch">
    ðŸ”Š Voz
    <label>
      <input type="checkbox" id="voz">
      <span class="slider"></span>
    </label>
  </div>

  <div class="switch">
    ðŸ“³ VibraciÃ³n
    <label>
      <input type="checkbox" id="vibracion">
      <span class="slider"></span>
    </label>
  </div>

  <button onclick="guardarPerfil()">Guardar</button>
  <button class="sec" onclick="mostrar('home')">Volver</button>

  <div class="footer">Desarrollado por CA TecnologÃ­a</div>
</div>

<!-- =========================
     MEDICAMENTOS
========================= -->
<div id="medicamentos" class="card hidden">
  <h2>Medicamentos</h2>

  <label>Nombre</label>
  <input id="medNombre">

  <label>Dosis (cantidad)</label>
  <input type="number" id="medDosis" min="1" value="1" onchange="generarHorarios()">

  <div id="horarios"></div>

  <label>DÃ­as de tratamiento</label>
  <input type="number" id="medDias">

  <label>Lugar donde se guarda</label>
  <input id="medLugar">

  <label>Foto (opcional)</label>
  <input type="file" id="medFoto" accept="image/*">

  <div class="switch">
    Permanente
    <label>
      <input type="checkbox" id="medPermanente">
      <span class="slider"></span>
    </label>
  </div>

  <button onclick="agregarMedicamento()">Guardar medicamento</button>
  <button class="sec" onclick="mostrar('home')">Volver</button>

  <div id="listaMedicamentos"></div>

  <div class="footer">Desarrollado por CA TecnologÃ­a</div>
</div>

<!-- =========================
     SEGUIMIENTO
========================= -->
<div id="seguimiento" class="card hidden">
  <h2>Seguimiento</h2>
  <p>En desarrolloâ€¦</p>
  <button class="sec" onclick="mostrar('home')">Volver</button>
  <div class="footer">Desarrollado por CA TecnologÃ­a</div>
</div>

</div>

<script>
/* =========================
   NAVEGACIÃ“N
========================= */
function mostrar(id){
  ["home","perfil","medicamentos","seguimiento"].forEach(s=>{
    document.getElementById(s).classList.add("hidden");
  });
  document.getElementById(id).classList.remove("hidden");
}

/* =========================
   PERFIL
========================= */
let perfil = JSON.parse(localStorage.getItem("perfil")) || {};

function calcularEdad(fecha){
  if(!fecha) return "";
  const h=new Date(), n=new Date(fecha);
  let a=h.getFullYear()-n.getFullYear();
  let m=h.getMonth()-n.getMonth();
  if(h.getDate()<n.getDate())m--;
  if(m<0){a--;m+=12;}
  return `${a} aÃ±os y ${m} meses`;
}

function guardarPerfil(){
  const tel=document.getElementById("cuidadorTelefono").value.replace(/\D/g,"");
  if(tel.length<8){
    alert("TelÃ©fono invÃ¡lido");
    return;
  }
  perfil={
    nombre:nombre.value,
    fechaNacimiento:fechaNacimiento.value,
    cuidadorNombre:cuidadorNombre.value,
    cuidadorTelefono:tel,
    voz:voz.checked,
    vibracion:vibracion.checked
  };
  localStorage.setItem("perfil",JSON.stringify(perfil));
  alert("Datos guardados correctamente");
  renderBienvenida();
}

function renderBienvenida(){
  if(!perfil.nombre) return;
  bienvenida.innerHTML=`<strong>Bienvenido ${perfil.nombre}</strong><br>
  Edad: ${calcularEdad(perfil.fechaNacimiento)}`;
}
renderBienvenida();

/* =========================
   MEDICAMENTOS
========================= */
let medicamentos=JSON.parse(localStorage.getItem("medicamentos"))||[];

function generarHorarios(){
  const d=+medDosis.value;
  horarios.innerHTML="";
  for(let i=1;i<=d;i++){
    horarios.innerHTML+=`<label>Horario ${i}</label><input type="time" class="h">`;
  }
}

function agregarMedicamento(){
  const hs=[...document.querySelectorAll(".h")].map(i=>i.value);
  const reader=new FileReader();
  reader.onload=()=>{
    medicamentos.push({
      nombre:medNombre.value,
      dosis:medDosis.value,
      horarios:hs,
      dias:medDias.value,
      lugar:medLugar.value,
      permanente:medPermanente.checked,
      foto:reader.result||""
    });
    localStorage.setItem("medicamentos",JSON.stringify(medicamentos));
    listarMedicamentos();
  };
  const f=medFoto.files[0];
  if(f) reader.readAsDataURL(f);
  else reader.onload();
}

function listarMedicamentos(){
  listaMedicamentos.innerHTML="";
  medicamentos.forEach(m=>{
    listaMedicamentos.innerHTML+=`
    <div class="med-item">
      <strong>${m.nombre}</strong><br>
      Dosis: ${m.dosis}<br>
      Horarios: ${m.horarios.join(", ")}<br>
      DÃ­as: ${m.dias}<br>
      Lugar: ${m.lugar}<br>
      ${m.foto?`<img src="${m.foto}">`:""}
    </div>`;
  });
}
listarMedicamentos();
</script>

</body>
</html>
