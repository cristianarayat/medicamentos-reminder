<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
/* =========================
   ESTILOS GENERALES
========================= */
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#f2f2f2;
  color:#333;
}

.container{
  max-width:420px;
  margin:auto;
  padding:16px;
}

.card{
  background:#fff;
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,.1);
}

h1,h2,h3{
  text-align:center;
  margin-top:0;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  margin-top:10px;
  background:#2f80ed;
  color:#fff;
  cursor:pointer;
}

button.secondary{
  background:#777;
}

input, select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ccc;
  font-size:15px;
}

label{
  font-size:14px;
  font-weight:bold;
}

.hidden{ display:none; }

.switch{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-top:10px;
}

.switch input{
  width:40px;
  height:20px;
}

/* =========================
   MEN√ö PRINCIPAL
========================= */
#home img{
  width:100%;
  margin-top:12px;
}

/* =========================
   MEDICAMENTOS
========================= */
.med-card{
  border:1px solid #ddd;
  border-radius:12px;
  padding:10px;
  margin-top:10px;
}

.med-card img{
  width:100%;
  border-radius:10px;
}

.days{
  display:flex;
  justify-content:space-between;
  margin-top:10px;
}

.days label{
  font-weight:normal;
}

/* =========================
   TOAST
========================= */
#toast{
  position:fixed;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  background:#333;
  color:#fff;
  padding:12px 20px;
  border-radius:20px;
  display:none;
}
</style>
</head>

<body>

<div class="container">

<!-- =========================
     HOME
========================= -->
<div id="home" class="card">
  <h1>üíä Recordatorio de Medicamentos</h1>
  <p id="bienvenida" style="text-align:center;"></p>

  <button onclick="mostrar('perfil')">Datos personales</button>
  <button onclick="mostrar('medicamentos')">Medicamentos</button>
  <button onclick="mostrar('seguimiento')">Seguimiento</button>

  <img src="activos/personas-inclusivas.png" alt="Personas">
  <p style="text-align:center;margin-top:10px;">Desarrollado por CA Tecnolog√≠a</p>
</div>

<!-- =========================
     DATOS PERSONALES
========================= -->
<div id="perfil" class="card hidden">
  <h2>Datos personales</h2>

  <label>Nombre</label>
  <input id="nombre">

  <label>Fecha de nacimiento</label>
  <input type="date" id="nacimiento">

  <label>Nombre cuidador</label>
  <input id="cuidador">

  <label>Tel√©fono cuidador</label>
  <input id="telefono">

  <div class="switch">
    <span>Vibraci√≥n</span>
    <input type="checkbox" id="vibrar">
  </div>

  <div class="switch">
    <span>Voz</span>
    <input type="checkbox" id="voz">
  </div>

  <button onclick="guardarPerfil()">Guardar</button>
  <button class="secondary" onclick="mostrar('home')">Volver</button>
</div>

<!-- =========================
     MEDICAMENTOS
========================= -->
<div id="medicamentos" class="card hidden">
  <h2>Medicamentos</h2>

  <label>Nombre medicamento</label>
  <input id="medNombre">

  <label>Dosis por d√≠a</label>
  <input type="number" id="medDosis" min="1" value="1" onchange="generarHorarios()">

  <div id="horarios"></div>

  <label>D√≠as</label>
  <div class="days">
    <label><input type="checkbox" value="L">L</label>
    <label><input type="checkbox" value="M">M</label>
    <label><input type="checkbox" value="X">X</label>
    <label><input type="checkbox" value="J">J</label>
    <label><input type="checkbox" value="V">V</label>
    <label><input type="checkbox" value="S">S</label>
    <label><input type="checkbox" value="D">D</label>
  </div>

  <label>Cantidad de d√≠as</label>
  <input type="number" id="cantDias">

  <div class="switch">
    <span>Permanente</span>
    <input type="checkbox" id="permanente" onchange="bloquearDias()">
  </div>

  <label>Lugar donde se guarda</label>
  <input id="lugar">

  <label>Foto (opcional)</label>
  <input type="file" id="foto" accept="image/*">

  <button onclick="guardarMedicamento()">Guardar medicamento</button>
  <button class="secondary" onclick="mostrar('home')">Volver</button>

  <div id="listaMedicamentos"></div>
</div>

<!-- =========================
     SEGUIMIENTO
========================= -->
<div id="seguimiento" class="card hidden">
  <h2>Seguimiento</h2>
  <p>Pr√≥ximamente</p>
  <button class="secondary" onclick="mostrar('home')">Volver</button>
</div>

</div>

<div id="toast"></div>

<script>
/* =========================
   UTILIDADES
========================= */
function mostrar(id){
  document.querySelectorAll('.card').forEach(c=>c.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
}

function toast(msg){
  const t=document.getElementById('toast');
  t.innerText=msg;
  t.style.display='block';
  setTimeout(()=>t.style.display='none',2500);
}

/* =========================
   PERFIL
========================= */
function guardarPerfil(){
  const tel=document.getElementById('telefono').value;
  if(tel.length<8){ toast("Tel√©fono inv√°lido"); return; }

  const data={
    nombre: nombre.value,
    nacimiento: nacimiento.value,
    cuidador: cuidador.value,
    telefono: tel,
    vibrar: vibrar.checked,
    voz: voz.checked
  };
  localStorage.setItem('perfil',JSON.stringify(data));
  toast("Datos guardados correctamente");
  actualizarBienvenida();
}

function actualizarBienvenida(){
  const p=JSON.parse(localStorage.getItem('perfil'));
  if(!p) return;
  const edad=calcularEdad(p.nacimiento);
  document.getElementById('bienvenida').innerText=
    `Bienvenido ${p.nombre} ‚Äì ${edad}`;
}

function calcularEdad(f){
  const n=new Date(f),h=new Date();
  let a=h.getFullYear()-n.getFullYear();
  let m=h.getMonth()-n.getMonth();
  if(m<0){a--;m+=12;}
  return `${a} a√±os y ${m} meses`;
}
actualizarBienvenida();

/* =========================
   MEDICAMENTOS
========================= */
let medicamentos=JSON.parse(localStorage.getItem('meds'))||[];

function generarHorarios(){
  const c=medDosis.value;
  const div=document.getElementById('horarios');
  div.innerHTML='';
  for(let i=1;i<=c;i++){
    div.innerHTML+=`
      <label>Horario ${i}</label>
      <input type="time" class="hora">
    `;
  }
}

function bloquearDias(){
  cantDias.disabled=permanente.checked;
}

function guardarMedicamento(){
  const horas=[...document.querySelectorAll('.hora')].map(h=>h.value);
  if(horas.includes("")){toast("Completa horarios");return;}

  const reader=new FileReader();
  reader.onload=()=>{
    medicamentos.push({
      nombre:medNombre.value,
      dosis:medDosis.value,
      horas,
      dias:[...document.querySelectorAll('.days input:checked')].map(d=>d.value),
      cant:cantDias.value,
      permanente:permanente.checked,
      lugar:lugar.value,
      foto:reader.result
    });
    localStorage.setItem('meds',JSON.stringify(medicamentos));
    mostrarMedicamentos();
    toast("Medicamento guardado");
  };
  if(foto.files[0]) reader.readAsDataURL(foto.files[0]);
  else reader.onload();
}

function mostrarMedicamentos(){
  const l=document.getElementById('listaMedicamentos');
  l.innerHTML='';
  medicamentos.forEach((m,i)=>{
    l.innerHTML+=`
      <div class="med-card">
        ${m.foto?`<img src="${m.foto}">`:''}
        <strong>${m.nombre}</strong><br>
        Horarios: ${m.horas.join(', ')}<br>
        <button onclick="eliminar(${i})">Eliminar</button>
      </div>
    `;
  });
}

function eliminar(i){
  medicamentos.splice(i,1);
  localStorage.setItem('meds',JSON.stringify(medicamentos));
  mostrarMedicamentos();
}
mostrarMedicamentos();
</script>

</body>
</html>
