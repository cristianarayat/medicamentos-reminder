<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recordatorio de Medicamentos</title>

<style>
:root{
  --azul:#2f80ed;
  --fondo:#f2f4f7;
  --blanco:#ffffff;
  --texto:#333;
}

*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}

body{
  margin:0;
  background:var(--fondo);
  color:var(--texto);
}

.container{
  max-width:420px;
  margin:0 auto;
  padding:20px;
}

.card{
  background:white;
  border-radius:16px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}

h1,h2{margin:0 0 10px}
h1{font-size:26px}
h2{font-size:20px}

.center{text-align:center}

.menu-btn{
  width:100%;
  padding:16px;
  border:none;
  border-radius:14px;
  background:var(--azul);
  color:white;
  font-size:16px;
  margin:10px 0;
  cursor:pointer;
}

.menu-btn.gray{
  background:#6c757d;
}

.footer{
  text-align:center;
  font-size:13px;
  opacity:.6;
  margin-top:20px;
}

/* switches */
.switch{
  position:relative;
  display:inline-block;
  width:46px;
  height:24px;
}
.switch input{display:none}
.slider{
  position:absolute;
  cursor:pointer;
  top:0;left:0;right:0;bottom:0;
  background:#ccc;
  transition:.4s;
  border-radius:24px;
}
.slider:before{
  position:absolute;
  content:"";
  height:18px;width:18px;
  left:3px;bottom:3px;
  background:white;
  transition:.4s;
  border-radius:50%;
}
input:checked + .slider{background:var(--azul)}
input:checked + .slider:before{transform:translateX(22px)}

.row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin:10px 0;
}

input,select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ccc;
  margin-bottom:12px;
  font-size:14px;
}

/* d√≠as */
.days{
  display:flex;
  justify-content:space-between;
}
.days label{
  font-size:12px;
}

/* medicamentos */
.med-item{
  border:1px solid #ddd;
  border-radius:12px;
  padding:10px;
  margin-top:10px;
}
.med-item img{
  width:100%;
  border-radius:10px;
  margin-top:6px;
}

.hidden{display:none}
</style>
</head>

<body>
<div class="container">

<!-- HOME -->
<div id="home" class="card center">
  <h1>üíä Recordatorio de Medicamentos</h1>

  <div id="bienvenida"></div>

  <img src="personas-inclusivas.png" style="width:100%;border-radius:16px;margin:15px 0">

  <button class="menu-btn" onclick="mostrar('perfil')">üë§ Datos personales</button>
  <button class="menu-btn" onclick="mostrar('medicamentos')">üíä Medicamentos</button>

  <div class="footer">Desarrollado por CA Tecnolog√≠a</div>
</div>

<!-- PERFIL -->
<div id="perfil" class="card hidden">
<h2>Datos personales</h2>

<input id="nombre" placeholder="Nombre">
<input id="fechaNacimiento" type="date">
<input id="cuidadorNombre" placeholder="Nombre del cuidador">
<input id="cuidadorTelefono" placeholder="Tel√©fono del cuidador">

<div class="row">
  <span>üì≥ Vibraci√≥n</span>
  <label class="switch">
    <input type="checkbox" id="vibracion">
    <span class="slider"></span>
  </label>
</div>

<div class="row">
  <span>üîä Voz</span>
  <label class="switch">
    <input type="checkbox" id="voz">
    <span class="slider"></span>
  </label>
</div>

<button class="menu-btn" onclick="guardarPerfil()">Guardar</button>
<button class="menu-btn gray" onclick="mostrar('home')">‚Üê Volver</button>

<div id="msgPerfil"></div>

<div class="footer">Desarrollado por CA Tecnolog√≠a</div>
</div>

<!-- MEDICAMENTOS -->
<div id="medicamentos" class="card hidden">
<h2>Medicamentos</h2>

<input id="medNombre" placeholder="Nombre del medicamento">
<input id="medDosis" type="number" min="1" placeholder="Cantidad de dosis por d√≠a">

<div id="horarios"></div>

<div class="days">
<label><input type="checkbox" value="L">L</label>
<label><input type="checkbox" value="M">M</label>
<label><input type="checkbox" value="X">X</label>
<label><input type="checkbox" value="J">J</label>
<label><input type="checkbox" value="V">V</label>
<label><input type="checkbox" value="S">S</label>
<label><input type="checkbox" value="D">D</label>
</div>

<input id="medDias" type="number" placeholder="Cantidad de d√≠as">

<div class="row">
  <span>Permanente</span>
  <label class="switch">
    <input type="checkbox" id="medPermanente">
    <span class="slider"></span>
  </label>
</div>

<input type="file" id="medFoto" accept="image/*">

<button class="menu-btn" onclick="guardarMedicamento()">Guardar medicamento</button>
<button class="menu-btn gray" onclick="mostrar('home')">‚Üê Volver</button>

<div id="listaMedicamentos"></div>

<div class="footer">Desarrollado por CA Tecnolog√≠a</div>
</div>

</div>

<script>
let usuario = JSON.parse(localStorage.getItem("usuario")) || {};
let medicamentos = JSON.parse(localStorage.getItem("medicamentos")) || [];

function mostrar(id){
  document.querySelectorAll(".card").forEach(c=>c.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function calcularEdad(fecha){
  if(!fecha) return "";
  const f = new Date(fecha);
  const hoy = new Date();
  let a√±os = hoy.getFullYear()-f.getFullYear();
  let meses = hoy.getMonth()-f.getMonth();
  if(meses<0){a√±os--;meses+=12}
  return `${a√±os} a√±os y ${meses} meses`;
}

function renderHome(){
  if(usuario.nombre){
    document.getElementById("bienvenida").innerHTML =
      `<h2>Bienvenido ${usuario.nombre}</h2>
       <p>Edad: ${calcularEdad(usuario.fechaNacimiento)}</p>`;
  }
}

function guardarPerfil(){
  const tel = document.getElementById("cuidadorTelefono").value.trim();
  if(tel.length < 8){
    alert("Tel√©fono inv√°lido");
    return;
  }
  usuario={
    nombre:nombre.value,
    fechaNacimiento:fechaNacimiento.value,
    cuidadorNombre:cuidadorNombre.value,
    cuidadorTelefono:tel,
    vibracion:vibracion.checked,
    voz:voz.checked
  };
  localStorage.setItem("usuario",JSON.stringify(usuario));
  document.getElementById("msgPerfil").innerHTML="‚úÖ Datos guardados correctamente";
  renderHome();
}

medDosis.oninput=()=>{
  horarios.innerHTML="";
  for(let i=0;i<medDosis.value;i++){
    horarios.innerHTML+=`<input type="time">`;
  }
}

function guardarMedicamento(){
  const tiempos=[...horarios.querySelectorAll("input")].map(i=>i.value);
  const dias=[...document.querySelectorAll(".days input:checked")].map(d=>d.value);

  const reader=new FileReader();
  reader.onload=()=>{
    medicamentos.push({
      nombre:medNombre.value,
      dosis:medDosis.value,
      horarios:tiempos,
      dias,
      diasCantidad:medDias.value,
      permanente:medPermanente.checked,
      foto:reader.result
    });
    localStorage.setItem("medicamentos",JSON.stringify(medicamentos));
    listarMedicamentos();
  };
  if(medFoto.files[0]) reader.readAsDataURL(medFoto.files[0]);
  else reader.onload();
}

function listarMedicamentos(){
  listaMedicamentos.innerHTML="";
  medicamentos.forEach(m=>{
    listaMedicamentos.innerHTML+=`
    <div class="med-item">
      <strong>${m.nombre}</strong><br>
      Dosis: ${m.dosis}<br>
      Horarios: ${m.horarios.join(", ")}<br>
      D√≠as: ${m.dias.join(" ")}<br>
      ${m.foto?`<img src="${m.foto}">`:""}
    </div>`;
  });
}

renderHome();
</script>
</body>
</html>
